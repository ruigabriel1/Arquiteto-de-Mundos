{% extends "base.html" %}

{% block title %}Detalhes do Personagem - {{ personagem.nome }}{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="row">
        <div class="col-md-8 offset-md-2">
            <div class="card bg-dark text-white shadow-lg">
                <div class="card-header d-flex justify-content-between align-items-center border-secondary">
                    <h3 class="mb-0"><i class="fas fa-user-circle me-2"></i>{{ personagem.nome }}</h3>
                    <div>
                        <a href="{% url 'personagens:editar' personagem.pk %}" class="btn btn-outline-light btn-sm me-2">
                            <i class="fas fa-edit me-1"></i>Editar
                        </a>
                        <a href="{% url 'personagens:listar' %}" class="btn btn-outline-secondary btn-sm">
                            <i class="fas fa-arrow-left me-1"></i>Voltar
                        </a>
                    </div>
                </div>
                <div class="card-body">
                    <div class="row mb-4">
                        <div class="col-md-4 text-center">
                            {% if personagem.avatar %}
                                <img src="{{ personagem.avatar.url }}" alt="{{ personagem.nome }}" class="img-fluid rounded-circle mb-3" style="width: 150px; height: 150px; object-fit: cover;">
                            {% else %}
                                <div class="bg-primary rounded-circle d-flex align-items-center justify-content-center mb-3" style="width: 150px; height: 150px;">
                                    <i class="fas fa-user fa-5x text-white"></i>
                                </div>
                            {% endif %}
                            <h5 class="mb-0">{{ personagem.nome }}</h5>
                            <p class="text-muted small">
                                {% if personagem.raca %}{{ personagem.raca.nome }}{% endif %}
                                {% if personagem.classe_principal %}{{ personagem.classe_principal.nome }}{% endif %}
                            </p>
                        </div>
                        <div class="col-md-8">
                            <ul class="list-group list-group-flush bg-dark">
                                <li class="list-group-item bg-dark text-white border-secondary">
                                    <strong>Campanha:</strong> {{ personagem.campanha.nome }}
                                </li>
                                <li class="list-group-item bg-dark text-white border-secondary">
                                    <strong>Sistema de Jogo:</strong> {{ personagem.sistema_jogo.nome }}
                                </li>
                                <li class="list-group-item bg-dark text-white border-secondary">
                                    <strong>Nível:</strong> {{ personagem.nivel }}
                                </li>
                                <li class="list-group-item bg-dark text-white border-secondary">
                                    <strong>XP:</strong> {{ personagem.experiencia }}
                                </li>
                                <li class="list-group-item bg-dark text-white border-secondary">
                                    <strong>Status:</strong> 
                                    {% if personagem.ativo %}
                                        <span class="badge bg-success">Ativo</span>
                                    {% else %}
                                        <span class="badge bg-secondary">Inativo</span>
                                    {% endif %}
                                </li>
                            </ul>
                        </div>
                    </div>

                    <hr class="border-secondary">

                    <h4 class="mb-3"><i class="fas fa-chart-bar me-2"></i>Atributos</h4>
                    <div class="row text-center mb-4">
                        {% for attr, value in personagem.atributos.items %}
                            <div class="col-4 col-md-2 mb-2">
                                <div class="p-2 border rounded bg-secondary bg-opacity-25">
                                    <small class="text-muted d-block">{{ attr|upper }}</small>
                                    <strong>{{ value }}</strong>
                                    <small class="text-info d-block">({{ modificadores|get_item:attr|default:"+0" }})</small>
                                </div>
                            </div>
                        {% endfor %}
                    </div>

                    <h4 class="mb-3"><i class="fas fa-heartbeat me-2"></i>Pontos de Vida</h4>
                    <ul class="list-group list-group-flush bg-dark mb-4">
                        <li class="list-group-item bg-dark text-white border-secondary">
                            <strong>PV Máximo:</strong> {{ pv_max }}
                        </li>
                        <li class="list-group-item bg-dark text-white border-secondary">
                            <strong>PV Atual:</strong> {{ personagem.pontos_vida_atual }}
                        </li>
                        <li class="list-group-item bg-dark text-white border-secondary">
                            <strong>PV Temporários:</strong> {{ personagem.pontos_vida_temporarios }}
                        </li>
                    </ul>

                    <h4 class="mb-3"><i class="fas fa-book-open me-2"></i>História & Personalidade</h4>
                    {% if personagem.historia %}
                        <p>{{ personagem.historia|linebreaksbr }}</p>
                    {% else %}
                        <p class="text-muted">Nenhuma história de fundo fornecida.</p>
                    {% endif %}

                    {% if personagem.personalidade %}
                        <h5 class="mt-4">Personalidade</h5>
                        <p>{{ personagem.personalidade|linebreaksbr }}</p>
                    {% endif %}

                    {% if personagem.anotacoes_jogador %}
                        <h5 class="mt-4">Anotações do Jogador</h5>
                        <p>{{ personagem.anotacoes_jogador|linebreaksbr }}</p>
                    {% endif %}

                    <h4 class="mb-3 mt-4"><i class="fas fa-scroll me-2"></i>Dados do Sistema</h4>
                    <ul class="list-group list-group-flush bg-dark">
                        <li class="list-group-item bg-dark text-white border-secondary">
                            <strong>Raça:</strong> {{ personagem.raca }}
                        </li>
                        <li class="list-group-item bg-dark text-white border-secondary">
                            <strong>Classes:</strong> {{ personagem.classes }}
                        </li>
                        <li class="list-group-item bg-dark text-white border-secondary">
                            <strong>Equipamentos:</strong> {{ personagem.equipamentos }}
                        </li>
                        <li class="list-group-item bg-dark text-white border-secondary">
                            <strong>Perícias:</strong> {{ personagem.pericias }}
                        </li>
                        <li class="list-group-item bg-dark text-white border-secondary">
                            <strong>Magias Conhecidas:</strong> {{ personagem.magias_conhecidas }}
                        </li>
                    </ul>

                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
